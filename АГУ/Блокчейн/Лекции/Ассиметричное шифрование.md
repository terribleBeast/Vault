## Проблема аутентичности ключа
Когда открытый ключ находится в открытом доступе, то его может подменить мошенник.
То есть открытый ключ может не соответствовать владельцу 

Технологи цифрового реестра 
Решение применение сертификатов

Сертификат - электронный документ, подтверждающий взаимосвязь между открытым ключом и идентификационными данными его владельца.

> [!NOTE] 
> Понятие сертификата впервые было введено Лореном Конфельдером в 1976 году для решения задачи снижения нагрузки и повышения отказоустойчивости сервера распределения открытых ключей. 

## Подходы к управлению доверием "проблема аутентичности"
## Pretty Good Privacy (PGP)

Первая версия PGP создана Филом Циммерманом в 1991
Не предусматривала никаких лицензий 
PGP исходно применялось в сети Usenet и оттуда распространилось и в Internet
Стали использоваться сертификаты для подтверждения подлинности ключей.

Децентрализованная сеть 
Сейчас третья волна децентрализации 
**Каждый может подписать сертификат для другого!** (третья доверенная сторона)
В PGP предполагался обмен данными

Более сложная схема 
![](Pasted%20image%2020250111182352.png)

Уровни доверия в PGP
Уровень доверия сертификата 
Уровень доверия поручителю, выдавшему сертификат
Уровень законности ключа (взвешенный уровень доверия пользователя)

вес 0 - сертификату, которому не доверяют (None
вес 1/2 - сертификату с частичным доверием Parch
вес 1 - сертификату с полным доверием Full

![](Pasted%20image%2020250111182746.png)
Ключ не может выполнять все функции (формирования зашифрованные сообщения, формирование ЭЦП)


> [!NOTE] Title
> Механизм связок ключей используется до сих пор (например, Linux)

Все построено относительно Алисы. Напоминает модель общества

![](Pasted%20image%2020250111183616.png)

![](Pasted%20image%2020250111183748.png)

![](Pasted%20image%2020250111184038.png)

![](Pasted%20image%2020250111184147.png)


## Инфраструктура  открытых ключей (Public key infrastructure - PKI)
Система распределения доверия к информации (отрытому ключу) с использованием ЭЦП.
![](Pasted%20image%2020250111184628.png)


Компоненты PKI
Международные стандарты ЭЦП основаны на российских стандартах.
Российские стандарты основаны на международных (являются адаптацией)
В соответствии с RFC3280 включает следующие компоненты:
- конечные объекты \[End Entity (EE)] - пользователя PKI (пользователи)
- центр сертификации  \[Certificate Authority (CA)] получили пару ключей и получается сертификат 
- репозиторий сертификатов \[Certificate Repository (CR)]хранилище сертификатов 
- центр регистрации \[Registration Authory (RA)]
- цифровые сертификаты \[Digital Certificates (X.509 V3)]
![](Компоненты%20PKI.png)


## Сертификат X.509 
### История развития 
1978 Вводится понятие сертификата (Конфельдер, BS EE Thesis MIT)
1988 X.509v1. Вводится понятие сертификата в контексте протокола аутентификации X.509.
1993 X.509v2. Индексация сертификата по ID открытого ключа.
1996 X.509v3. Появление дополнений в сертификате
1999 IETF PKIX group (RFC2459)
2000 X.509v4 PMI - инфраструктура управления привилегиями

Компоненты 
![](сертификат%20x.509.png)

Расширения сертификата X.509 
Расширения сертификата - механиз снабжения открытого ключа дополнительной информацией, необходимой для его использования.

Виды дополнений:
- Стандартные определены в рамках стандарта X.509
- Специальные определяются разработчиками прикладных систем для служебных целей 
- Пользовательские опредеяются конечным пользователем прикладной системы 

Стандартные расширения  X.509
определяются стандартом X.509

Содержат 
- Информацию о ключе и политеке 
	- Уникальный 
	- Область использования (Key Usage / Extended Key Usage) может быть только одна (например, только для подписи одной организации)
	- Срок действия секретного ключа
	- Регламент исопльзщования сертификата
	- Policy Mapings
- Информация об издателе и владельце (Subject / Authory Alternative Name)
- Ограничения на цепочку сертификатов (Basic Constraints - Path Length Constraints)
- Информацию о статусе сертификата (CRL Distribution Points / Authority Informmation Access)
Область испольщования ключа

Определяет семантику использования открытого ключа в приложениях 
1. Область использования ключа (key usage)
	- Цифровая подпись (Digital Signature)
	- Data encrypting
	- Key encrypting и т.п.
2. Extended key usage
	- Secure E-mail
	- SSL / TLS Client Authentication
	- SSL / TLS Server Authenrication 

Ограничения на цепочку сертификата 
Уровень доверия в цепочках сертификатов включает
- Основные ограничения (Basic Constraints)
	- ограничения на длину цепочки сертификации (сколько центров сертификации можно пров)
- Ограничения имен (Name Constraints) ограничения на пространство имен, в котором осуществляется построение цепочки сертификации 
- Ограничения политик (policy Constraints) ограничения на регламент сертификатов, учавствующих в цепочке

Информация о статусе сертификации 
Определяет локализацию и метод доступа к статусной информации. Проверка на истечения срока действия сертификата 

Включаетс точки распространения списков отозванных сертификатов (CRL Distribution Point)
- По содержиому CRL (CRL, ARL)
- По методу доступа (LDAP, HTTP, FTP

![](статус%20сертификата.png)

Понятие доверия в PKI
Инфраструктура открытых ключей - система распространения доверия к информации (открытому ключу)
Сертификат носитель доверия

Домен доверия - множество PKI-систем, объединенных единым управлением или являющихся субъектами некоторого общего набора политик безопасности 

"Доверие в PKI" включает понятия:
- Домена доверия 
- Модели доверия
- "Якоря" доверия
- Отношения доверия
Выделения доменов доверия и их границ - один из первых этапов в построении PKI.

Домены формируются по:
- географическому признаку 
- организацонному признаку
- структуре бизнес-процессов


![](иерархическая%20модель%20PKI.png)
Root CA - самоподписанный сертификат
![](сетевая%20модель%20PKI.png)
![](мостовая%20модель%20pki.png)
Ограничения по длине проверки

![](сравнение%20%20моделей%20PKI.png)
Могут быть использованы вместе


Построение пути сертификации 
Осуществляется в прямом (для иерархических моделей) и обратном (для сетевых моделей) направлении

Исходные данные
- проверяемый сертификат
- Сертификат "якоря" доверия

Идентификация сертификата в цепочке
- Отличительное имя
- Уникальный идентификатор ключа
- Локализация сертификата в сетевом каталоге

Оптимизация пути сертифкации
- Сертификаты из одного пространства име
- ппуть минимальной длины 

Ограничения
- ислючение дублированных сертификатов (предотвращение циклов)


![](этапы%20жизненного%20цикла%20сертификата%20(отрытого%20ключа).png)


Распротранение сертификата

online - методы
- доступ к сетевому каталогу (LDAP, HTTP, FTP)
offline - методы
- рассылка по жлектронной почте
- распространение вместе с документамми, защищенными с и спользованием сертифкатов

Аутентификация доступа к хранилищам сертификатов - SSL, LDAP
Отдельный вопрос 0 расростраение сертификата корневого центра сертификации (ЦС) (якоря доверяи )


Испольщование сертификата 

Этапы
1. валидация 
2. испольщование в случае валидности

Сртификат является валидным, если 
- подпись по дсертификатом вернаъ
- подпись проверена с использованием открытого ключа издателя
- Срок действия сертификата не истек
- используется для тех целей, для которых он был создан
- Сертификат не отозван

Обновление сертификата 
Причины
- окончание срока действия ключа
- изменение регистрационных данных владельца (обычно в доп поля)

Может быть
Обновление сертификата пользователя
Обновление сертификата корневого ЦС

Сертификат не может быть бесконечно долгим

Отзыв сертификата
причины
- изменение регистрациоонных данных (актулально
- компрометация ключа (неактуально

![](компрометация%20сертификата.png)


![](Стандартизация%20PKI.png)
на нижнем уровне SSL используетс PKI

![](PKCS.png)

![](стандарты%20PKIX.png)

![](уровни%20работы%20стандартов.png)

Понятие криптоинтерфейса

Это набор спецификаций для подключения различных провйдеров услыг криптографии (криптопровайдеров) к прикладной системе

Интерфейсы: 
Microsoft CryptoAPI, 
PKCS#11-Cryptoky низкоуровневый абстракктный интерфейс доступа к криптографическому устройству пройдеру 

![](Понятие%20криптоинтерфейса.png)

![](Pasted%20image%2020250111195427.png)

Основные приложения PKI
- обмен жлектронными сообзениями (S/MIME)
- Доступ к WEBрусурсам  (SSL/TLS)
- Защита удаленного доступа (IPSec VPN / SSL VPN) (организация защищенного канала)
- Защита файлов на диске
![](схема%20работы%20ssl%20tsl.png)

Шифрующая файловая система (Ecrypting File System)
интегририрована с NTFS
Прозрачное шифрование файлов
Возможность восстановления зашифрованных данных 

интегрирована в Windows

![](схема%20работы%20EFS%20шифрование.png)
Симметричное шифрование не используют для шифрвоания больших данных (сессия в TLS)
DES устарел

![](схема%20работы%20EFS%20расшифрование.png)

Система PKI чаще всего это иерархия и цепочки проверок. В блокчейне данные плоские (все участники равны) В блоках отдельные блокченах могу т подписываться ЭЦП и тогда будет PKI (иерархической).

